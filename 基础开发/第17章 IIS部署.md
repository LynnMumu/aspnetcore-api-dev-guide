# IIS部署

## 目录
- [Windows Server 2019安裝IIS](#windows-server-2019安裝IIS)
- [发布与部署到IIS](#发布与部署到IIS)


## Windows Server 2019安裝IIS
在Windows Server 2019上安装IIS（Internet Information Services）是一个相对简单的过程。以下是详细的步骤：

### 1. 打开服务器管理器
- 登录到你的Windows Server 2019。
- 在桌面上，点击 **“开始”** 菜单，然后选择 **“服务器管理器”**。

### 2. 添加角色和功能
- 在服务器管理器中，点击左侧的 **“管理”**，然后选择 **“添加角色和功能”**。
- 在 **“添加角色和功能向导”** 中，点击 **“下一步”**。

### 3. 选择安装类型
- 选择 **“基于角色或基于功能的安装”**，然后点击 **“下一步”**。

### 4. 选择目标服务器
- 选择你要在其上安装IIS的服务器（通常是本地服务器），然后点击 **“下一步”**。

### 5. 选择角色
- 在 **“选择服务器角色”** 页面，找到并勾选 **“Web 服务器（IIS）”** 选项。
- 你可能会看到一个对话框，询问你是否要添加所需的功能，点击 **“添加功能”**。
- 点击 **“下一步”**。

### 6. 选择功能
- 在 **“选择功能”** 页面上，你可以选择额外的功能（可选），然后点击 **“下一步”**。

### 7. IIS 角色服务
- 在 **“Web 服务器角色”** 页面，选择你需要的IIS角色服务。默认情况下，基本的Web服务已选中。
- 如果你需要额外的功能（如FTP、管理工具等），可以在这里勾选。
- 点击 **“下一步”**。

### 8. 确认安装
- 在 **“确认”** 页面，检查你的选择，然后点击 **“安装”**。

### 9. 安装进度
- 等待安装完成。安装过程可能需要几分钟。
- 安装完成后，可以选择立即启动IIS管理器，点击 **“关闭”**。

### 10. 访问IIS管理器
- 在 **“服务器管理器”** 中，点击左侧的 **“工具”**，然后选择 **“Internet 信息服务(IIS)管理器”**。
- 或者，您也可以通过搜索 **“IIS”** 来找到并打开 **IIS管理器**。

### 11. 测试IIS
- 打开浏览器，输入 `http://localhost`。如果IIS安装成功，您将看到默认的IIS欢迎页面。

### 注意事项
- 确保服务器上没有防火墙阻止HTTP(S)流量（默认是80端口和443端口）。
- 根据需要配置SSL证书，以启用HTTPS。

## 发布与部署到IIS

### 发布应用程序

#### 1. 使用 Visual Studio 发布
如果你使用 Visual Studio 开发应用程序，可以通过以下步骤进行发布：

1. **打开你的项目**：
   - 启动 Visual Studio 并打开要发布的项目。

2. **右键单击项目**：
   - 在解决方案资源管理器中，右键单击你的项目。

3. **选择“发布”**：
   - 在上下文菜单中选择 **“发布”**。
![1730442508458](https://github.com/user-attachments/assets/bbfb4bf8-81bd-4254-b5b1-40194e51b324)

4. **选择发布目标**：
   - 在发布向导中选择 **“文件系统”**（或其他适合你需要的选项）。

5. **设置目标路径**：
   - 选择一个本地文件夹作为目标路径，发布文件将被保存到此文件夹。
![1730442519843](https://github.com/user-attachments/assets/ab95a618-4131-4948-8c96-56e8e8fe1b1b)
![1730442527620](https://github.com/user-attachments/assets/017fbb48-a889-4b63-9ec6-cc93a6d4b413)

6. **配置其他选项**（可选）：
   - 你可以选择发布配置（Debug/Release），并配置其他选项（如文件发布选线等）。
![1730442542470](https://github.com/user-attachments/assets/d6273bbf-93de-4c0a-bda2-3be37c37c848)

7. **点击“发布”**：
   - 完成所有设置后，点击 **“发布”** 按钮。Visual Studio 将生成并发布应用程序。
![1730442554487](https://github.com/user-attachments/assets/d8867f88-6347-4cde-a682-cd45fa9768ba)

### 部署到 IIS

#### 1. 确保 IIS 已安装并配置
在之前的步骤中，你已经安装了 IIS。确保你在 IIS 中已配置应用程序池和站点。

#### 2. 创建网站
1. **打开 IIS 管理器**：
   - 在服务器上，打开 **IIS 管理器**。

2. **添加新站点**：
   - 在左侧的 **“连接”** 面板中，右键单击 **“网站”**，选择 **“添加网站”**。
   
3. **设置站点名称和物理路径**：
   - 输入网站名称。
   - 选择发布文件的物理路径（即在上一步中选择的文件夹）。
   - 选择端口（默认是 80），如果需要，可以配置绑定。
  
4. **配置应用程序池**：
   - 确保选择了合适的应用程序池，特别是对于 ASP.NET Core 应用程序，需要使用 **“无托管代码”** 的应用程序池。
   
5. **点击“确定”**：
   - 完成后，点击 **“确定”** 创建网站。

#### 3. 设置权限
确保 IIS 用户（如 `IIS_IUSRS`）对发布文件夹有适当的权限（读取、写入等）。

1. **右键点击文件夹**：
   - 找到发布文件的文件夹，右键点击，选择 **“属性”**。

2. **选择“安全”选项卡**：
   - 点击 **“编辑”**，添加 `IIS_IUSRS` 用户，并赋予读取权限。

### 4. 配置应用程序设置
对于 ASP.NET Core 应用程序，确保在 `web.config` 文件中正确配置应用程序设置。

### 5. 启动站点
- 在 IIS 管理器中，选择你刚创建的站点，点击右侧的 **“启动”** 按钮。

### 6. 测试访问
- 在浏览器中，输入 `http://<你的服务器IP或域名>`，检查应用程序是否成功运行。

